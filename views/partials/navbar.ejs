<div class="container navbar-container">
	<nav class="navbar navbar-expand-lg navbar-dark">
		<div class="container-fluid">
			<a class="navbar-brand" href="/">Freelancer BG</a>

			<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
				data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-default navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item">
						<a class="nav-link active" aria-current="page" href="/joblist">Всички обяви</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" aria-current="page" href="/specialists">Специалисти</a>
					</li>
					<!-- <li class="nav-item">
						<a class="nav-link active" href="why" method="GET">Kakvo e freelance?</a>
					</li> -->

				</ul>
				<!-- <form class="d-flex">
					<input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
					<button class="btn btn-outline-success" type="submit">Search</button>
				</form> -->
				<form role="search" style="padding-right: 5px;">
					<div class="container">
						<div class="row">
							<div class="col-md-10">

							</div>
							<div class="col-md-2">

							</div>
						</div>
					</div>
				</form>
				<% if(currentUser) { %>
					<a href="/messages" style="margin-right: 2%; ">
					<svg xmlns="http://www.w3.org/2000/svg" width="39" height="39" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16" style="color:white">
						<path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z"/>
					  </svg>
					</a>
					<a href="/profile"><button style="margin-right: 15px;" class="btn btn-light">Профил</button></a>

					<a href="../auth/logout"><button class="btn btn-danger">Изход</button></a>

					<% }else { %>
						<!-- Button trigger modal -->
						<button style="margin-right: 1%; color: white;" type="button" class="btn" id="login-button"
							style="background-color:transparent" data-bs-toggle="modal" data-bs-target="#exampleModal">
							<span>Вход</span>
						</button>

						<!-- Modal -->
						<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
							aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" style="color: black;" id="exampleModalLabel">Вход в
											системата</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>
									<div class="container modal-body">

										<form id="loginForm" action="/auth/local" method="POST">
											<div class="mb-3">
												<label for="exampleInputEmail1" class="form-label">Email</label>
												<input type="email" name="email" class="form-control"
													id="exampleInputEmail1" aria-describedby="emailHelp">
												<div id="emailHelp" class="form-text"> </div>
											</div>
											<div class="mb-3">
												<label for="exampleInputPassword1" class="form-label">Парола</label>
												<input type="password" name="password" class="form-control"
													id="exampleInputPassword1">
											</div>
											<div id="loginPopup" style="color: red;"></div>
											<button type="submit" class="btn btn-success">Вход</button>
										</form>
										<div class="container social-buttons">
											<p style="color: black; margin-top: 2%;">Или влез чрез любимата ти
												социална мрежа</p>
											<a href="/auth/facebook">
												<button type="button" class="btn btn-primary">

													<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
														fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
														<path
															d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z">
														</path>
													</svg>
													Facebook
												</button>
											</a>
											<a href="/auth/google">
												<button type="button" class="btn btn-outline-danger">
													<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
														fill="currentColor" class="bi bi-google" viewBox="0 0 16 16">
														<path
															d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z">
														</path>
													</svg>
													Google
												</button>
											</a>
										</div>
										<!-- <form action="/auth/local" method="POST">
												<label for="email">email</label>
												<input type="text" name="email">
												<label for="password">password</label>
												<input type="password" name="password">
												<button type="submit">Вход</button>
											</form> -->
									</div>

								</div>
							</div>
						</div>

						<!-- Button trigger modal -->
						<button type="button" class="btn btn-success btn-rounded" data-bs-toggle="modal"
							data-bs-target="#exampleModal2">
							Регистрация
						</button>

						<!-- Modal 	-->
						<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel"
							aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" style="color: black;" id="exampleModalLabel2">
											Регистрация</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal"
											aria-label="Close"></button>
									</div>
									<div class="container modal-body">

										<form id="registerForm" action="/auth/local" method="POST">
											<div class="mb-3">
												<label for="exampleInputEmail1" class="form-label">Име</label>
												<input type="text" name="name" class="form-control"
													id="exampleInputEmail1" aria-describedby="emailHelp">
												<div id="emailHelp" class="form-text"></div>
											</div>
											<div class="mb-3">
												<label for="exampleInputEmail1" class="form-label">Фамилия</label>
												<input type="text" name="surname" class="form-control"
													id="exampleInputEmail1" aria-describedby="emailHelp">
												<div id="emailHelp" class="form-text"></div>
											</div>
											<div class="mb-3">
												<label for="registrationNickname" class="form-label">Потребителско
													име</label>
												<input type="text" name="nickname" class="form-control"
													id="registrationNickname" aria-describedby="emailHelp">
												<div id="emailHelp" class="form-text"></div>
												<div id="nicknameAvailable"></div>
											</div>
											
											<div class="mb-3">
												<label for="registrationEmail" class="form-label">Email</label>
												<input type="email" name="email" class="form-control"
													id="registrationEmail" aria-describedby="emailHelp">
												<div id="emailHelp" class="form-text"></div>
											</div>
											<div id="emailAvailable"></div>

											<div class="mb-3">
												<label for="exampleInputPassword1" class="form-label">Парола</label>
												<input type="password" name="password" class="form-control"
													id="exampleInputPassword1">
											</div>


											<button type="submit" class="btn btn-success">Регистрация</button>
										</form>
										<!-- <form action="/auth/local" method="POST">
												<label for="email">email</label>
												<input type="text" name="email">
												<label for="password">password</label>
												<input type="password" name="password">
												<button type="submit">Вход</button>
											</form> -->
										<div class="container social-buttons">
											<p style="color: black; margin-top: 2%;">Или чрез със любимата ти
												социална мрежа</p>
											<a href="/auth/facebook">
												<button type="button" class="btn btn-primary">
													<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
														fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
														<path
															d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z">
														</path>
													</svg>

													Facebook
												</button>
											</a>

											<a href="/auth/google">
												<button type="button" class="btn btn-outline-danger">
													<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
														fill="currentColor" class="bi bi-google" viewBox="0 0 16 16">
														<path
															d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z">
														</path>
													</svg>
													Google
												</button>
											</a>
										</div>
									</div>

								</div>
							</div>
						</div>

						<% } %>






			</div>
		</div>
	</nav>
</div>

<script>
	$(function(){
        $('#loginForm').on('submit', function(e) {
            e.preventDefault();
            var data =  $(this).serialize();
            $.post('/auth/local', data, function(result) {
                if(result.valid == true)
                {
                    window.location.href = '/profile';
                }
                else
                {
                    $('#loginPopup').html("Грешна парола");
					console.log(result)
                }
            });
        });
    });

	// const nickname = document.getElementById('registrationNickname');
	// nickname.addEventListener('keyup', function(e){
	// 	if(nickname.value !== ''){
	// 	fetch(`/auth/checknickname/` + nickname.value).then(result=> result.json().then(json => {
	// 		if(json.nick == "taken"){
	// 			document.getElementById('nicknameAvailable').innerHTML = "<span style='color: red;'>Потребителското име е заето</span>";
	// 		}else {
	// 			document.getElementById('nicknameAvailable').innerHTML = "<span style='color: green;'>Потребителското име е свободно</span>";
	// 		}
	// 	}) )
	// }
	// })
	$('#registrationNickname').on('input', _.debounce(function (e) {
		fetch(`/auth/checknickname/` + this.value).then(result=> result.json().then(json => {
			if(json.nick == "taken"){
				document.getElementById('nicknameAvailable').innerHTML = "<span style='color: red;'>Потребителското име е заето</span>";
			}else {
				document.getElementById('nicknameAvailable').innerHTML = "<span style='color: green;'>Потребителското име е свободно</span>";
			}
		}) )
	}
, 500));

	$('#registrationEmail').on('input', _.debounce(function (e) {
		fetch(`/auth/checkemail/` + this.value).then(result=> result.json().then(json => {
			if(json.nick == "taken"){
				document.getElementById('emailAvailable').innerHTML = "<span style='color: red;'>Email е зает</span>";
			}else {
				document.getElementById('emailAvailable').innerHTML = "<span style='color: green;'>Email е свободен</span>";
			}
		}) )
	}
, 500));



	// const email = document.getElementById('registrationEmail');
	// email.addEventListener('keyup', function(e){
	// 	if(email.value !== ''){
	// 	fetch(`/auth/checkemail/` + email.value).then(result=> result.json().then(json => {
	// 		if(json.nick == "taken"){
	// 			document.getElementById('emailAvailable').innerHTML = "<span style='color: red;'>Email е зает</span>";
	// 		}else {
	// 			document.getElementById('emailAvailable').innerHTML = "<span style='color: green;'>Email е свободен</span>";
	// 		}
	// 	}) )
	// }
	// })
   

	




	// const input = document.getElementById('search');

	// 				input.addEventListener('keypress', (e) => {
	// 					if (e.key === 'Enter') {
	// 						const val = input.value;
	// 						console.log(val)
	// 						// console.log("The term searched for was " + input.value);
	// 						fetch('/joblist/filtered/' + input.value).then(result => result.json()).then(json => {
	// 							console.log(json)
	// 							Array.from(document.getElementsByClassName("job-results-container")).forEach(el => {
	// 								const parent = el.parentNode;

	// 								el.innerHTML = json.map(job => {
	// 									console.log(job)
										// let createdAt = job.createdAt;
										// function timeCreated(){
										// 	moment(job.createdAt, "YYYYMMDD" ).fromNow();
										// }




	
</script>
